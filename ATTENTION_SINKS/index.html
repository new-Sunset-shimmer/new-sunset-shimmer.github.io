<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ATTENTION SINKS | Sunset</title>
<meta name="keywords" content="Pruning, Paper">
<meta name="description" content="Attention sink를 해결하여 window attention 방식을 효율화">
<meta name="author" content="">
<link rel="canonical" href="https://new-sunset-shimmer.github.io/ATTENTION_SINKS/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://new-sunset-shimmer.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://new-sunset-shimmer.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://new-sunset-shimmer.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://new-sunset-shimmer.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://new-sunset-shimmer.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://new-sunset-shimmer.github.io/ATTENTION_SINKS/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {

         
        .post-content input[type="checkbox"]:checked~label>img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }

        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
</style><meta property="og:title" content="ATTENTION SINKS" />
<meta property="og:description" content="Attention sink를 해결하여 window attention 방식을 효율화" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://new-sunset-shimmer.github.io/ATTENTION_SINKS/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-12-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ATTENTION SINKS"/>
<meta name="twitter:description" content="Attention sink를 해결하여 window attention 방식을 효율화"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://new-sunset-shimmer.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ATTENTION SINKS",
      "item": "https://new-sunset-shimmer.github.io/ATTENTION_SINKS/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ATTENTION SINKS",
  "name": "ATTENTION SINKS",
  "description": "Attention sink를 해결하여 window attention 방식을 효율화",
  "keywords": [
    "Pruning", "Paper"
  ],
  "articleBody": "2309.17453 (arxiv.org)\nFull Title : EFFICIENT STREAMING LANGUAGE MODELS WITH ATTENTION SINKS\nReleased Date : 2024 04 07\nReview Date : 2024 10 21\nAttention sink를 해결하여 window attention 방식을 효율화\nMotivation LLM의 놀라운 성능에도 불구하고 높은 계산량, 큰 사이즈등의 문제가 존재한다. 계산 비용을 낮추기 위해 흔히 사용되는 KV cache 방법론은 효과적이다. 그럼에도 불구하고 KV cache 큰 메모리 비용을 잡아 먹는 단점이 존재해 특정 토큰을 잘라 내지만 성능을 많이 깍아 먹는다. 이번 논문에서는 특정 토큰을 잘라 사용 하면서도 성능을 보존하면서 계산 효율을 올리는 방법론을 제시한다. long context에도 많이 쓰인다. Research questions 효율적이고 빠른 LLM 서비스를 위한 계산효율을 어떻게 늘릴까? Methodology 저자들은 Attention sink이라는 어텐션 Layer에서 sequence의 오직 첫번째 token에 sementic에 상관없이 무조건 과집중하는 현상이 발견했다. 저자들은 이러한 현상이 발생하는 이유를 2가지의 원인이 존재한다고 설명했다\nsoftmax 함수는 절대로 0이라는 값이 나오지 않으며 모든 token에 일정 비율 학습이 진행된다. - Auto-regressive 모델의 특성상 첫번째 token이 중복으로 학습된다. - 위의 문제들을 근거하여 위해 저자들은 첫번째 token을 살리면서 window attention을 진행하는 방식으로 문제를 해결했다 Sink token이라는 token을 학습시 맨 앞에 넣어 오직 하나의 token에만 집중할수있게 만들어 모델을 pretraining 시켰다. 모델은 Pythia-160M Append Personal thought slind window을 StreamingLLM에 적용시키면 어떻게 되는가? ",
  "wordCount" : "186",
  "inLanguage": "en",
  "datePublished": "2024-12-12T00:00:00Z",
  "dateModified": "2024-12-12T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://new-sunset-shimmer.github.io/ATTENTION_SINKS/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sunset",
    "logo": {
      "@type": "ImageObject",
      "url": "https://new-sunset-shimmer.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://new-sunset-shimmer.github.io/" accesskey="h" title="Sunset (Alt + H)">Sunset</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://new-sunset-shimmer.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      ATTENTION SINKS
    </h1>
    <div class="post-meta"><span title='2024-12-12 00:00:00 +0000 UTC'>December 12, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#research-questions" aria-label="Research questions">Research questions</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li></ul>
                    
                <li>
                    <a href="#append" aria-label="Append">Append</a><ul>
                        
                <li>
                    <a href="#personal-thought" aria-label="Personal thought">Personal thought</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><a href="https://arxiv.org/pdf/2309.17453">2309.17453 (arxiv.org)</a></p>
<blockquote>
<p>Full Title : EFFICIENT STREAMING LANGUAGE MODELS
WITH ATTENTION SINKS</p>
</blockquote>
<blockquote>
<p>Released Date : 2024 04 07</p>
</blockquote>
<blockquote>
<p>Review Date : 2024 10 21</p>
</blockquote>
<p>Attention sink를 해결하여 window attention 방식을 효율화</p>
<p>

<input type="checkbox" id="zoomCheck-b026a" hidden>
<label for="zoomCheck-b026a">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8064-bb23-c44df5c47c1c.png#center" alt=""  />
</label></p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<ul>
<li>LLM의 놀라운 성능에도 불구하고 높은 계산량, 큰 사이즈등의 문제가 존재한다. 계산 비용을 낮추기 위해 흔히 사용되는 KV cache 방법론은 효과적이다. 그럼에도 불구하고 KV cache 큰 메모리 비용을 잡아 먹는 단점이 존재해 특정 토큰을 잘라 내지만 성능을 많이 깍아 먹는다. 이번 논문에서는 특정 토큰을 잘라 사용 하면서도 성능을 보존하면서 계산 효율을 올리는 방법론을 제시한다. long context에도 많이 쓰인다.</li>
</ul>
<h3 id="research-questions">Research questions<a hidden class="anchor" aria-hidden="true" href="#research-questions">#</a></h3>
<ul>
<li>효율적이고 빠른 LLM 서비스를 위한 계산효율을 어떻게 늘릴까?</li>
</ul>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<ul>
<li>저자들은 Attention sink이라는 어텐션 Layer에서 sequence의 오직 첫번째 token에 sementic에 상관없이 무조건 과집중하는 현상이 발견했다.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-41d70" hidden>
<label for="zoomCheck-41d70">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/76a612d3-a4ce-4b5c-8431-de8944d75db0.png#center" alt=""  />
</label></p>
<ul>
<li>
<p>저자들은 이러한 현상이 발생하는 이유를 2가지의 원인이 존재한다고 설명했다</p>
<ul>
<li>softmax 함수는 절대로 0이라는 값이 나오지 않으며 모든 token에 일정 비율 학습이 진행된다.</li>
</ul>
</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-99cb2" hidden>
<label for="zoomCheck-99cb2">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/19ec53f5-5aea-42fa-9106-26a5da453895.png#center" alt=""  />
</label></p>
<pre><code>- Auto-regressive 모델의 특성상 첫번째 token이 중복으로 학습된다. 

- 위의 문제들을 근거하여 위해 저자들은 첫번째 token을 살리면서 window attention을 진행하는 방식으로 문제를 해결했다
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-ed621" hidden>
<label for="zoomCheck-ed621">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/f69c3ecd-fb95-4392-a453-7b497861c8df.png#center" alt=""  />
</label></p>
<ul>
<li>Sink token이라는 token을 학습시 맨 앞에 넣어 오직 하나의 token에만 집중할수있게 만들어 모델을 pretraining 시켰다.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-35e3a" hidden>
<label for="zoomCheck-35e3a">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/f00b45c1-a467-462d-8686-87862be8f5c7.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-74569" hidden>
<label for="zoomCheck-74569">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/25b45c2a-2d52-41ae-9559-7578b5bae64c.png#center" alt=""  />
</label></p>
<pre><code>모델은 Pythia-160M
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-e7581" hidden>
<label for="zoomCheck-e7581">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/574be441-8f04-452b-a5f7-82be680c07e1.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-a092b" hidden>
<label for="zoomCheck-a092b">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-804f-971b-de0ffe944e9a.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-bf08c" hidden>
<label for="zoomCheck-bf08c">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8093-848d-cff2e9e6bd7a.png#center" alt=""  />
</label></p>
<h2 id="append">Append<a hidden class="anchor" aria-hidden="true" href="#append">#</a></h2>
<p>

<input type="checkbox" id="zoomCheck-da410" hidden>
<label for="zoomCheck-da410">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80da-bb6a-d69d7344df1a.png#center" alt=""  />
</label></p>
<hr>
<h3 id="personal-thought">Personal thought<a hidden class="anchor" aria-hidden="true" href="#personal-thought">#</a></h3>
<ol>
<li>slind window을 StreamingLLM에 적용시키면 어떻게 되는가?</li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://new-sunset-shimmer.github.io/tags/pruning/">Pruning</a></li>
      <li><a href="https://new-sunset-shimmer.github.io/tags/paper/">Paper</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://new-sunset-shimmer.github.io/">Sunset</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
