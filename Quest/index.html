<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Quest | Sunset</title>
<meta name="keywords" content="Quantization, Paper">
<meta name="description" content="KV Cache에서 필요없는 token 버리기">
<meta name="author" content="">
<link rel="canonical" href="https://new-sunset-shimmer.github.io/Quest/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://new-sunset-shimmer.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://new-sunset-shimmer.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://new-sunset-shimmer.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://new-sunset-shimmer.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://new-sunset-shimmer.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://new-sunset-shimmer.github.io/Quest/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {

         
        .post-content input[type="checkbox"]:checked~label>img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }

        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
</style><meta property="og:title" content="Quest" />
<meta property="og:description" content="KV Cache에서 필요없는 token 버리기" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://new-sunset-shimmer.github.io/Quest/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-12-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Quest"/>
<meta name="twitter:description" content="KV Cache에서 필요없는 token 버리기"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://new-sunset-shimmer.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Quest",
      "item": "https://new-sunset-shimmer.github.io/Quest/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Quest",
  "name": "Quest",
  "description": "KV Cache에서 필요없는 token 버리기",
  "keywords": [
    "Quantization", "Paper"
  ],
  "articleBody": "Quest: Query-Aware Sparsity for Efficient Long-Context LLM Inference (arxiv.org)\nQuest: Query-Aware Sparsity for Efficient Long-Context LLM Inference\nReleased Date : 2024 08 26\nReview Date : 2024 10 04\nKV Cache에서 필요없는 token 버리기\nMotivation Self attention에서 KV Cache는 Sequence가 길경우 많은 메모리를 사용한다. 해당 문제를 해결하기 위해서 Token을 버리는 방법을 저자들은 제안했다. Static하게 Token을 버릴 경우 미래에 필요한 Token도 같이 버려질 가능성이 높기에 Query 기반으로 버리는 방법을 제안한다. Methodology KV에서 K를 기준으로 가장높은 키값과 가장 낮은 키값을 Query와 Element-wise Product 연산을 통해서 값을 구한다. Element-wised Matrix에서 가장 높은 값들만 구한뒤 Sum한다. Top-k의 page만 로드하면 된다. Main result ",
  "wordCount" : "98",
  "inLanguage": "en",
  "datePublished": "2024-12-12T00:00:00Z",
  "dateModified": "2024-12-12T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://new-sunset-shimmer.github.io/Quest/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sunset",
    "logo": {
      "@type": "ImageObject",
      "url": "https://new-sunset-shimmer.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://new-sunset-shimmer.github.io/" accesskey="h" title="Sunset (Alt + H)">Sunset</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://new-sunset-shimmer.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Quest
    </h1>
    <div class="post-meta"><span title='2024-12-12 00:00:00 +0000 UTC'>December 12, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li>
                <li>
                    <a href="#main-result" aria-label="Main result">Main result</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><a href="https://arxiv.org/pdf/2406.10774">Quest: Query-Aware Sparsity for Efficient Long-Context LLM Inference (arxiv.org)</a></p>
<blockquote>
<p>Quest: Query-Aware Sparsity for Efficient Long-Context LLM Inference</p>
</blockquote>
<blockquote>
<p>Released Date : 2024 08 26</p>
</blockquote>
<blockquote>
<p>Review Date : 2024 10 04</p>
</blockquote>
<p>KV Cache에서 필요없는 token 버리기</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<ul>
<li>Self attention에서 KV Cache는 Sequence가 길경우 많은 메모리를 사용한다. 해당 문제를 해결하기 위해서 Token을 버리는 방법을 저자들은 제안했다. Static하게 Token을 버릴 경우 미래에 필요한 Token도 같이 버려질 가능성이 높기에 Query 기반으로 버리는 방법을 제안한다.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-f9d88" hidden>
<label for="zoomCheck-f9d88">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-808e-912b-ebf18246ee77.png#center" alt=""  />
</label></p>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<ul>
<li>KV에서 K를 기준으로 가장높은 키값과 가장 낮은 키값을 Query와 Element-wise Product 연산을 통해서 값을 구한다. Element-wised Matrix에서 가장 높은 값들만 구한뒤 Sum한다. Top-k의 page만 로드하면 된다.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-eb845" hidden>
<label for="zoomCheck-eb845">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80c2-9108-e03aa0b2b960.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-35f41" hidden>
<label for="zoomCheck-35f41">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80e8-bee8-d0ea6e95e649.png#center" alt=""  />
</label></p>
<h3 id="main-result">Main result<a hidden class="anchor" aria-hidden="true" href="#main-result">#</a></h3>
<p>

<input type="checkbox" id="zoomCheck-3aae1" hidden>
<label for="zoomCheck-3aae1">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-806e-9997-e123693cad22.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-0b205" hidden>
<label for="zoomCheck-0b205">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8080-bc92-e3b968a669a8.png#center" alt=""  />
</label></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://new-sunset-shimmer.github.io/tags/quantization/">Quantization</a></li>
      <li><a href="https://new-sunset-shimmer.github.io/tags/paper/">Paper</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://new-sunset-shimmer.github.io/">Sunset</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
