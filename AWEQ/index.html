<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>AWEQ | Sunset</title>
<meta name="keywords" content="Quantization, Paper">
<meta name="description" content="Activation-Weight Equalization &#43; Bias Correction">
<meta name="author" content="">
<link rel="canonical" href="https://new-sunset-shimmer.github.io/AWEQ/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://new-sunset-shimmer.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://new-sunset-shimmer.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://new-sunset-shimmer.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://new-sunset-shimmer.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://new-sunset-shimmer.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://new-sunset-shimmer.github.io/AWEQ/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {

         
        .post-content input[type="checkbox"]:checked~label>img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }

        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
</style><meta property="og:title" content="AWEQ" />
<meta property="og:description" content="Activation-Weight Equalization &#43; Bias Correction" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://new-sunset-shimmer.github.io/AWEQ/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-12-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AWEQ"/>
<meta name="twitter:description" content="Activation-Weight Equalization &#43; Bias Correction"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://new-sunset-shimmer.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "AWEQ",
      "item": "https://new-sunset-shimmer.github.io/AWEQ/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AWEQ",
  "name": "AWEQ",
  "description": "Activation-Weight Equalization + Bias Correction",
  "keywords": [
    "Quantization", "Paper"
  ],
  "articleBody": " Full Title : AWEQ: Post-Training Quantization with Activation-Weight Equalization for Large Language Models\nLink : 2311.01305 (arxiv.org)\nRelated Link : SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org),\nReleased Date : Thu, 2 Nov 2023\nReview Date : Tue, 10 Dec 2024\nActivation-Weight Equalization + Bias Correction\nMotivation From recent(in 2023) research they are propose mitigate complexity to another. In example, Smoothquant they are mitigate activation quantize complexity to weight complexity. Activation got huge magnitude values named outliers(some paper name it as salient value) make quantization harder. Also awq mitigate complexity to another in order to quantize in extremely low-bit. In this paper mitigate activation quantize complexity, bias error to weight by per channel also ensuring robustness of the model. Research questions can we mitigate complexity also guarantee robustness Methodology Quantization with Activation-Weight Equalization(AWE)\nr is represnet equalized i-th cannel, R denote range of the equalized tensor, specifiacally, it is the maximum value minus the minimum value for all channel.\nIn the end pi is equalized i-th channel by whole tensor\n- Authors aim to find s such that the total precision(pi) per channel is maximized. - equantion 5 is can derive to equation 6. R is can be maxj(1/sj * rj) that is maximum value of the equalized tensor. r is i-th channel without equalization. - Authors can sum-out r(this value not very important to find s). Authors only use argmaxs that can be denote argmins if we change divinder to divinded. - uniqueness for robustness(simplify) we set equation 9 manually. because if we thins argmaxj and argmaxk is not equal there is numerous solutions for equation 8 - To further address the issue of diversity in the solutions for s, we directly assume r(What) = r(xhat)(equalized channels are equivalent), Finally we can say si make ri(w) and ri(x) equal. so we can express it as equation 10 Quantization Bias Correction(BC)\nwe can get Block’s bias error(how much expected value moved) by equation 11. N is represent the number of input data used to count the quantization error - epsilon is sub of quantized weight with original weight - by derivation authors can get equation 15. We can obtain epsilon by precompute for activation quantization. Main result Accuracy of AWEQ average accuracy of table 1 8A8W ablation experiments on AWE, BC impact on model Personal thought low explain on equation derive ",
  "wordCount" : "395",
  "inLanguage": "en",
  "datePublished": "2024-12-12T00:00:00Z",
  "dateModified": "2024-12-12T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://new-sunset-shimmer.github.io/AWEQ/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sunset",
    "logo": {
      "@type": "ImageObject",
      "url": "https://new-sunset-shimmer.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://new-sunset-shimmer.github.io/" accesskey="h" title="Sunset (Alt + H)">Sunset</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://new-sunset-shimmer.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      AWEQ
    </h1>
    <div class="post-meta"><span title='2024-12-12 00:00:00 +0000 UTC'>December 12, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#research-questions" aria-label="Research questions">Research questions</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li>
                <li>
                    <a href="#main-result" aria-label="Main result">Main result</a></li>
                <li>
                    <a href="#personal-thought" aria-label="Personal thought">Personal thought</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>Full Title : AWEQ: Post-Training Quantization with Activation-Weight Equalization for Large Language Models</p>
</blockquote>
<blockquote>
<p>Link : <a href="https://arxiv.org/pdf/2311.01305">2311.01305 (arxiv.org)</a></p>
</blockquote>
<blockquote>
<p>Related Link : <a href="https://arxiv.org/pdf/2211.10438">SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org)</a>,</p>
</blockquote>
<blockquote>
<p>Released Date :  Thu, 2 Nov 2023</p>
</blockquote>
<blockquote>
<p>Review Date : Tue, 10 Dec 2024</p>
</blockquote>
<p>Activation-Weight Equalization + Bias Correction</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<ul>
<li>From recent(in 2023) research they are propose mitigate complexity to another. In example, Smoothquant they are mitigate activation quantize complexity to weight complexity. Activation got huge magnitude values named outliers(some paper name it as salient value) make quantization harder. Also awq mitigate complexity to another in order to quantize in extremely low-bit. In this paper mitigate activation quantize complexity, bias error to weight by per channel also ensuring robustness of the model.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-57087" hidden>
<label for="zoomCheck-57087">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/670e154e-7e10-41e2-b193-dd18b92d4a5d.png#center" alt=""  />
</label></p>
<h3 id="research-questions">Research questions<a hidden class="anchor" aria-hidden="true" href="#research-questions">#</a></h3>
<ul>
<li>can we mitigate complexity also guarantee robustness</li>
</ul>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<p>

<input type="checkbox" id="zoomCheck-363d4" hidden>
<label for="zoomCheck-363d4">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8023-86da-c2bc458825f1.png#center" alt=""  />
</label></p>
<ul>
<li>
<p>Quantization with Activation-Weight Equalization(AWE)</p>
<ul>
<li>
<p>r is represnet equalized i-th cannel, R denote range of the equalized tensor, specifiacally, it is the maximum value minus the minimum value for all channel.</p>
<p>In the end pi is equalized i-th channel by whole tensor</p>
</li>
</ul>
</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-bb386" hidden>
<label for="zoomCheck-bb386">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/4606e74a-ca80-4ab2-9b56-c2979ad6d5ee.png#center" alt=""  />
</label></p>
<pre><code>- Authors aim to find s such that the total precision(pi) per channel is maximized.
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-b049e" hidden>
<label for="zoomCheck-b049e">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/f6803690-524d-414e-8359-79fee78c5f1a.png#center" alt=""  />
</label></p>
<pre><code>- equantion 5 is can derive to equation 6. R is can be maxj(1/sj * rj) that is maximum value of the equalized tensor. r is i-th channel without equalization.
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-054f4" hidden>
<label for="zoomCheck-054f4">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/901db138-50ec-404f-8ffd-5bd809c1a8fd.png#center" alt=""  />
</label></p>
<pre><code>- Authors can sum-out r(this value not very important to find s). Authors only use argmaxs that can be denote argmins if we change divinder to divinded. 
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-33c70" hidden>
<label for="zoomCheck-33c70">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/6b10de14-6f62-467b-8f0e-9647402234eb.png#center" alt=""  />
</label></p>
<pre><code>- uniqueness for robustness(simplify) we set equation 9 manually. because if we thins argmaxj and argmaxk is not equal there is numerous solutions for equation 8
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-e0231" hidden>
<label for="zoomCheck-e0231">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/2736d13d-8532-495c-a407-47ed6d52cb6e.png#center" alt=""  />
</label></p>
<pre><code>- To further address the issue of diversity in the solutions for s, we directly assume r(What) = r(xhat)(equalized channels are equivalent), Finally we can say si make ri(w) and ri(x) equal. so we can express it as equation 10
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-27b1a" hidden>
<label for="zoomCheck-27b1a">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/e9f4c076-79c8-4d7a-8af4-a20ff91beaa1.png#center" alt=""  />
</label></p>
<ul>
<li>
<p>Quantization Bias Correction(BC)</p>
<ul>
<li>we can get Block’s bias error(how much expected value moved) by equation 11. N is represent the number of input data used to count the quantization error</li>
</ul>
</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-f87a8" hidden>
<label for="zoomCheck-f87a8">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/d4343e95-31d3-4aa0-a3f9-17e73d1950f2.png#center" alt=""  />
</label></p>
<pre><code>- epsilon is sub of quantized weight with original weight 
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-440d2" hidden>
<label for="zoomCheck-440d2">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/a865654c-203a-435d-9cb6-820d5648bb01.png#center" alt=""  />
</label></p>
<pre><code>- by derivation authors can get equation 15. We can obtain epsilon by precompute for activation quantization. 
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-7cf12" hidden>
<label for="zoomCheck-7cf12">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/7f4b7ee0-7a8f-4de8-afec-72aec2715a51.png#center" alt=""  />
</label></p>
<h3 id="main-result">Main result<a hidden class="anchor" aria-hidden="true" href="#main-result">#</a></h3>
<ul>
<li>Accuracy of AWEQ</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-b2f95" hidden>
<label for="zoomCheck-b2f95">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8098-9888-fe9090c4e6d3.png#center" alt=""  />
</label></p>
<ul>
<li>average accuracy of table 1</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-3e49b" hidden>
<label for="zoomCheck-3e49b">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80da-b757-f56c5b6eff55.png#center" alt=""  />
</label></p>
<ul>
<li>8A8W</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-68943" hidden>
<label for="zoomCheck-68943">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-803e-9dff-f85913ff9017.png#center" alt=""  />
</label></p>
<ul>
<li>ablation experiments on AWE, BC impact on model</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-33c00" hidden>
<label for="zoomCheck-33c00">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80d7-8bad-c39f2e530b5f.png#center" alt=""  />
</label></p>
<h3 id="personal-thought">Personal thought<a hidden class="anchor" aria-hidden="true" href="#personal-thought">#</a></h3>
<ul>
<li>low explain on equation derive</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://new-sunset-shimmer.github.io/tags/quantization/">Quantization</a></li>
      <li><a href="https://new-sunset-shimmer.github.io/tags/paper/">Paper</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://new-sunset-shimmer.github.io/">Sunset</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
