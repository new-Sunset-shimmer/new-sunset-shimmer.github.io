<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>DuQuant | Sunset</title>
<meta name="keywords" content="Paper, Quantization">
<meta name="description" content="ZigZag matrix for mitigate outlier to activation channels">
<meta name="author" content="">
<link rel="canonical" href="https://new-sunset-shimmer.github.io/DuQuant/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://new-sunset-shimmer.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://new-sunset-shimmer.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://new-sunset-shimmer.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://new-sunset-shimmer.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://new-sunset-shimmer.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://new-sunset-shimmer.github.io/DuQuant/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {

         
        .post-content input[type="checkbox"]:checked~label>img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }

        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
</style><meta property="og:title" content="DuQuant" />
<meta property="og:description" content="ZigZag matrix for mitigate outlier to activation channels" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://new-sunset-shimmer.github.io/DuQuant/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-12-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-19T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="DuQuant"/>
<meta name="twitter:description" content="ZigZag matrix for mitigate outlier to activation channels"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://new-sunset-shimmer.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "DuQuant",
      "item": "https://new-sunset-shimmer.github.io/DuQuant/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DuQuant",
  "name": "DuQuant",
  "description": "ZigZag matrix for mitigate outlier to activation channels",
  "keywords": [
    "Paper", "Quantization"
  ],
  "articleBody": " Full Title : DuQuant: Distributing Outliers via Dual Transformation Makes Stronger Quantized LLMs\nLink : 2406.01721 (arxiv.org)\nRelated Link : SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org)\nReleased Date : Mon, 3 Jun 2024\nReview Date : Mon, 16 Dec 2024\nZigZag matrix for mitigate outlier to activation channels\nMotivation outliers are huge problem for model quantization because it make quantized matrix more sparse and make quantization denotation unstable. Smoothequant is proposed method that smooth outlier in activation and trade-off between wieght matrix. but in figure 1 smooth quant can’t elimate massive activation also in weight new outlier appear. In this paper authors propose smoothing more than smoothequant also trade-off between all blocks\nResearch questions Can we make weight and outlier more smoother?\nMethodology The proposed DuQuant Method\nIn this paper use method of smoothquant. first they smoothing all tensor. but mentioned above this method can’t smooth all dimention especially massive actiavation The Rotation Transformation\nAfter smoothing need to rotation for more flattenness in order to they use random orthonagy matrix R(greedy searched). E is swapping matrix that change column of first index and outlier indeces. Also adding extra randomness they use random orthogonal matrix Q’. R1 is meaning first block, find all R for all block But it is hard to find all R efficiently so they find Cin X Cin once The Permutation Transformation\nEven if we flatten the activation is hard to quantize because of unclear distribution. in one block many outliers are exist. for prevelenting it we need to permutate blocks to reduce variance of median of all blocks. it means we ensure distribute outliers to other block The Overall DuQuant Method\nOverall authors smooth 2 steps\nMain result apply per-token activation quantization and per-channel weight quantization\nPersonal thought little bit messy method but cleaver ",
  "wordCount" : "303",
  "inLanguage": "en",
  "datePublished": "2024-12-19T00:00:00Z",
  "dateModified": "2024-12-19T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://new-sunset-shimmer.github.io/DuQuant/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sunset",
    "logo": {
      "@type": "ImageObject",
      "url": "https://new-sunset-shimmer.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://new-sunset-shimmer.github.io/" accesskey="h" title="Sunset (Alt + H)">Sunset</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://new-sunset-shimmer.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      DuQuant
    </h1>
    <div class="post-meta"><span title='2024-12-19 00:00:00 +0000 UTC'>December 19, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#research-questions" aria-label="Research questions">Research questions</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li>
                <li>
                    <a href="#main-result" aria-label="Main result">Main result</a></li>
                <li>
                    <a href="#personal-thought" aria-label="Personal thought">Personal thought</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>Full Title : DuQuant: Distributing Outliers via Dual Transformation Makes Stronger Quantized LLMs</p>
</blockquote>
<blockquote>
<p>Link : <a href="https://arxiv.org/pdf/2406.01721">2406.01721 (arxiv.org)</a></p>
</blockquote>
<blockquote>
<p>Related Link : <a href="https://arxiv.org/pdf/2211.10438">SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org)</a></p>
</blockquote>
<blockquote>
<p>Released Date :  Mon, 3 Jun 2024</p>
</blockquote>
<blockquote>
<p>Review Date : Mon, 16 Dec 2024</p>
</blockquote>
<p>ZigZag matrix for mitigate outlier to activation channels</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<p>outliers are huge problem for model quantization because it make quantized matrix more sparse and make quantization denotation unstable. Smoothequant is proposed method that smooth outlier in activation and trade-off between wieght matrix. but in figure 1 smooth quant can’t elimate massive activation also in weight new outlier appear. In this paper authors propose smoothing more than smoothequant also trade-off between all blocks</p>
<p>

<input type="checkbox" id="zoomCheck-7472c" hidden>
<label for="zoomCheck-7472c">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-8023-bc5c-cdd9056380a4.png#center" alt=""  />
</label></p>
<h3 id="research-questions">Research questions<a hidden class="anchor" aria-hidden="true" href="#research-questions">#</a></h3>
<p>Can we make weight and outlier more smoother?</p>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<p>

<input type="checkbox" id="zoomCheck-b83ff" hidden>
<label for="zoomCheck-b83ff">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-80d0-bec9-d52418357510.png#center" alt=""  />
</label></p>
<p>The proposed DuQuant Method</p>
<ul>
<li>In this paper use method of smoothquant. first they smoothing all tensor. but mentioned above this method can’t smooth all dimention especially massive actiavation</li>
</ul>
<p>The Rotation Transformation</p>
<ul>
<li>After smoothing need to rotation for more flattenness in order to they use random orthonagy matrix R(greedy searched). E is swapping matrix that change column of first index and outlier indeces. Also adding extra randomness they use random orthogonal matrix Q’. R1 is meaning first block, find all R for all block</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-86e51" hidden>
<label for="zoomCheck-86e51">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/26f85ad2-0d4a-40e5-bc1c-4904d5325052.png#center" alt=""  />
</label></p>
<pre><code>But it is hard to find all R efficiently so they find Cin X Cin once
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-31291" hidden>
<label for="zoomCheck-31291">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/afa0bf6d-619d-423b-b8ae-8f57a1367fd1.png#center" alt=""  />
</label></p>
<p>The Permutation Transformation</p>
<ul>
<li>Even if we flatten the activation is hard to quantize because of unclear distribution. in one block many outliers are exist. for prevelenting it we need to permutate blocks to reduce variance of median of all blocks. it means we ensure distribute outliers to other block</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-185c8" hidden>
<label for="zoomCheck-185c8">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/89eaca0d-0c5a-472a-8c28-642e8f866aee.png#center" alt=""  />
</label></p>
<p>The Overall DuQuant Method</p>
<p>Overall authors smooth 2 steps</p>
<p>

<input type="checkbox" id="zoomCheck-f83db" hidden>
<label for="zoomCheck-f83db">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-80b0-84de-ce457284a7e7.png#center" alt=""  />
</label></p>
<h3 id="main-result">Main result<a hidden class="anchor" aria-hidden="true" href="#main-result">#</a></h3>
<p>apply per-token activation
quantization and per-channel weight quantization</p>
<p>

<input type="checkbox" id="zoomCheck-37878" hidden>
<label for="zoomCheck-37878">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-808a-af74-ee070a940591.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-2c994" hidden>
<label for="zoomCheck-2c994">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-8044-ab94-d75b57d3b722.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-ab47f" hidden>
<label for="zoomCheck-ab47f">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-80ff-8ec7-e0c5f9186150.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-3cf22" hidden>
<label for="zoomCheck-3cf22">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-8043-9f6e-f82776918228.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-ecb11" hidden>
<label for="zoomCheck-ecb11">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-800f-b65c-e291045e1207.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-ac3b2" hidden>
<label for="zoomCheck-ac3b2">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-80db-92c7-d35e87656e5d.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-05994" hidden>
<label for="zoomCheck-05994">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-8075-9091-c380dda3b335.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-d92ad" hidden>
<label for="zoomCheck-d92ad">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-806e-8763-fc84a7002362.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-8bea2" hidden>
<label for="zoomCheck-8bea2">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/161415f9-e659-805a-9cf6-e8f76397c241.png#center" alt=""  />
</label></p>
<h3 id="personal-thought">Personal thought<a hidden class="anchor" aria-hidden="true" href="#personal-thought">#</a></h3>
<ul>
<li>little bit messy method but cleaver</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://new-sunset-shimmer.github.io/tags/paper/">Paper</a></li>
      <li><a href="https://new-sunset-shimmer.github.io/tags/quantization/">Quantization</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://new-sunset-shimmer.github.io/">Sunset</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
