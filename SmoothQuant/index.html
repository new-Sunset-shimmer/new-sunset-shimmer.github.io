<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SmoothQuant | Sunset</title>
<meta name="keywords" content="Quantization, Paper">
<meta name="description" content="Make easy weight and activation to quantize">
<meta name="author" content="">
<link rel="canonical" href="https://new-sunset-shimmer.github.io/SmoothQuant/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css" integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U&#43;6hYRq/Ez/nm5vg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://new-sunset-shimmer.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://new-sunset-shimmer.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://new-sunset-shimmer.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://new-sunset-shimmer.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://new-sunset-shimmer.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://new-sunset-shimmer.github.io/SmoothQuant/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><style>
    @media screen and (min-width: 769px) {

         
        .post-content input[type="checkbox"]:checked~label>img {
            transform: scale(1.6);
            cursor: zoom-out;
            position: relative;
            z-index: 999;
        }

        .post-content img.zoomCheck {
            transition: transform 0.15s ease;
            z-index: 999;
            cursor: zoom-in;
        }
    }
</style><meta property="og:title" content="SmoothQuant" />
<meta property="og:description" content="Make easy weight and activation to quantize" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://new-sunset-shimmer.github.io/SmoothQuant/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-12-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-12-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SmoothQuant"/>
<meta name="twitter:description" content="Make easy weight and activation to quantize"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://new-sunset-shimmer.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "SmoothQuant",
      "item": "https://new-sunset-shimmer.github.io/SmoothQuant/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SmoothQuant",
  "name": "SmoothQuant",
  "description": "Make easy weight and activation to quantize",
  "keywords": [
    "Quantization", "Paper"
  ],
  "articleBody": " Full Title : SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models\nLink : SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org)\nRelated Link : mit-han-lab/smoothquant: [ICML 2023] SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (github.com)AWQ (notion.so)\nReleased Date : Fri, 18 Nov 2022\nReview Date : Web, Nov 20th 2024\nMake easy weight and activation to quantize\nMotivation LLM is hard to quantize because of outlier. outlier is huge magnitude values that appear fixed channels. it is make activation harder to quantize. in this paper we make x to make smoother so we can quantize easy. in order to that we split complexity of activation quantize to weight Research questions can we split complexity of activation to weight ? Methodology In general per-cahnnel quantization is very effective. but it is not compatible with GEMM kernels. Speed of Per-channel quantization is as same as FP16.\nIn this paper we need to find scaling factor s to smooth the values. but if we find by max(x), all of complexity migrate to weight. if we find by 1/max(w) activation is still hard to quantize. so we need to trade of between x and w. alpha is real number between 0-1.0. Alpha is can find between what is the important number to make both easy to quantize. eventually we make Activation to easy to quantization. Also easy to quantize by tensor\nSmoothquant use INT8 GEMM. Softmax and LayerNorm layer user FP16.\nMain result Smooth quant use per tensor. Per-tensor dynamic mean in online and static is mean pre compute the Scale Accuracy and ppl of evalution by lm_eval harness SmoothQuant works on various architectures\nPersonal thought If it work on 4W4A ? ",
  "wordCount" : "286",
  "inLanguage": "en",
  "datePublished": "2024-12-12T00:00:00Z",
  "dateModified": "2024-12-12T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://new-sunset-shimmer.github.io/SmoothQuant/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sunset",
    "logo": {
      "@type": "ImageObject",
      "url": "https://new-sunset-shimmer.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://new-sunset-shimmer.github.io/" accesskey="h" title="Sunset (Alt + H)">Sunset</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://new-sunset-shimmer.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://new-sunset-shimmer.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      SmoothQuant
    </h1>
    <div class="post-meta"><span title='2024-12-12 00:00:00 +0000 UTC'>December 12, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a></li>
                <li>
                    <a href="#research-questions" aria-label="Research questions">Research questions</a></li>
                <li>
                    <a href="#methodology" aria-label="Methodology">Methodology</a></li>
                <li>
                    <a href="#main-result" aria-label="Main result">Main result</a></li>
                <li>
                    <a href="#personal-thought" aria-label="Personal thought">Personal thought</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>Full Title : SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models</p>
</blockquote>
<blockquote>
<p>Link : <a href="https://arxiv.org/pdf/2211.10438">SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (arxiv.org)</a></p>
</blockquote>
<blockquote>
<p>Related Link : <a href="https://github.com/mit-han-lab/smoothquant/tree/main">mit-han-lab/smoothquant: [ICML 2023] SmoothQuant: Accurate and Efficient Post-Training Quantization for Large Language Models (github.com)</a><a href="https://www.notion.so/AWQ-eee5609a8e804e8e81171b792d1d3766">AWQ (notion.so)</a></p>
</blockquote>
<blockquote>
<p>Released Date : Fri, 18 Nov 2022</p>
</blockquote>
<blockquote>
<p>Review Date : Web, Nov 20th 2024</p>
</blockquote>
<p>Make easy weight and activation to quantize</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<ul>
<li>LLM is hard to quantize because of outlier. outlier is huge magnitude values that appear fixed channels. it is make activation harder to quantize. in this paper we make x to make smoother so we can quantize easy. in order to that we split complexity of activation quantize to weight</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-4c3de" hidden>
<label for="zoomCheck-4c3de">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/e0558263-7349-4bf6-b8f8-33c877fce8c4.png#center" alt=""  />
</label></p>
<h3 id="research-questions">Research questions<a hidden class="anchor" aria-hidden="true" href="#research-questions">#</a></h3>
<ul>
<li>can we split complexity of activation to weight ?</li>
</ul>
<h3 id="methodology">Methodology<a hidden class="anchor" aria-hidden="true" href="#methodology">#</a></h3>
<ul>
<li>In general per-cahnnel quantization is very effective. but it is not compatible with GEMM kernels.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-674f8" hidden>
<label for="zoomCheck-674f8">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8000-a016-f19e3824a3ac.png#center" alt=""  />
</label></p>
<p>Speed of Per-channel quantization is as same as FP16.</p>
<p>

<input type="checkbox" id="zoomCheck-93d15" hidden>
<label for="zoomCheck-93d15">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8083-8137-df4514008574.png#center" alt=""  />
</label></p>
<ul>
<li>In this paper we need to find scaling factor s to smooth the values.</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-250d6" hidden>
<label for="zoomCheck-250d6">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/6d2a445f-947e-4436-9b45-2230d5c26202.png#center" alt=""  />
</label></p>
<pre><code>but if we find by max(x), all of complexity migrate to weight. if we find by 1/max(w) activation is still hard to quantize. so we need to trade of between x and w. 

alpha is real number between 0-1.0. Alpha is can find between what is the important number to make both easy to quantize. 
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-e0c22" hidden>
<label for="zoomCheck-e0c22">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/d9acd9ff-3d0c-4b9e-b967-0fd6eedd3cad.png#center" alt=""  />
</label></p>
<pre><code>eventually we make Activation to easy to quantization.
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-47ef8" hidden>
<label for="zoomCheck-47ef8">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-801e-8c29-d85b5b7b37ea.png#center" alt=""  />
</label></p>
<p>Also easy to quantize by tensor</p>
<p>

<input type="checkbox" id="zoomCheck-e4e05" hidden>
<label for="zoomCheck-e4e05">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8014-a33c-d33a44434e38.png#center" alt=""  />
</label></p>
<p>Smoothquant use INT8 GEMM. Softmax and LayerNorm layer user FP16.</p>
<p>

<input type="checkbox" id="zoomCheck-e8189" hidden>
<label for="zoomCheck-e8189">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-803a-9d35-fda69951f0f6.png#center" alt=""  />
</label></p>
<h3 id="main-result">Main result<a hidden class="anchor" aria-hidden="true" href="#main-result">#</a></h3>
<ul>
<li>Smooth quant use per tensor. Per-tensor dynamic mean in online and static is mean pre compute the Scale</li>
</ul>
<p>

<input type="checkbox" id="zoomCheck-4e9d7" hidden>
<label for="zoomCheck-4e9d7">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/d7d2a29c-e63a-4bb6-bb57-3aca6f8238e9.png#center" alt=""  />
</label></p>
<pre><code>Accuracy and ppl of evalution by lm_eval harness
</code></pre>
<p>

<input type="checkbox" id="zoomCheck-b072e" hidden>
<label for="zoomCheck-b072e">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80f4-aa6c-e9f16f851702.png#center" alt=""  />
</label></p>
<p>SmoothQuant works on various architectures</p>
<p>

<input type="checkbox" id="zoomCheck-454f6" hidden>
<label for="zoomCheck-454f6">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8004-b7ed-e1a79b70e8b1.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-720f8" hidden>
<label for="zoomCheck-720f8">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-8039-b01b-c2dbdbf885ff.png#center" alt=""  />
</label></p>
<p>

<input type="checkbox" id="zoomCheck-14709" hidden>
<label for="zoomCheck-14709">
    <img class="zoomCheck" loading="lazy" decoding="async" src="/images/15a415f9-e659-80f1-ae02-ff698cc9a6fb.png#center" alt=""  />
</label></p>
<h3 id="personal-thought">Personal thought<a hidden class="anchor" aria-hidden="true" href="#personal-thought">#</a></h3>
<ul>
<li>If it work on 4W4A ?</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://new-sunset-shimmer.github.io/tags/quantization/">Quantization</a></li>
      <li><a href="https://new-sunset-shimmer.github.io/tags/paper/">Paper</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://new-sunset-shimmer.github.io/">Sunset</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
